# 北京邮电大学计算机学院程序设计实践性能作业

## 一、 wordst_bad.cpp 数据测试

1. 测试用的文本的单词数量
    `864`

2. 文本所含的不同单词的数量（根据运行结果得出）
    `487`

3. 排名前三的单词及其数量
```
    the                 21   1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39
    ai                  19   3,5,9,11,13,15,18,19,21,23,25,27,29,31,33,36,37,39,41
    of                  19   1,3,5,7,9,11,13,15,17,19,23,25,29,31,33,35,37,39,41
```

4. 执行所用时间（time命令的显示结果）
    `Time taken: 399 ms`

## 二、修改说明

1. 用 `std::unordered_map` 替代 `std::map：`
    `std::unordered_map` 提供平均 `O(1)` 的查找和插入复杂度，相比 `std::map` 的 `O(log n)`，处理大数据时性能提升显著。

2. 避免动态内存分配：
    不再使用 `new` 分配 `WordInfo`，改为直接通过引用存储在 `std::unordered_map` 中，减少开销并提高内存管理效率。

3. 优化输入处理：
    使用 `std::ifstream` 读取文件，比 `fgetc` 更现代化，性能也更高。
    通过检查 `word.empty()` 确定是否需要处理单词，避免冗余的 `lastChar` 检查。

4. 优化 `statisWord` 函数：
    利用 `std::unordered_map` 的默认值自动创建功能，简化逻辑。

5. 减少重复行号：
    确保连续出现的相同单词不会重复添加相同行号。

6. 改进排序效率：
    直接在 `std::vector` 的单词对上进行排序，比自定义容器排序更高效。

7. 减少函数调用开销：
    内联使用 `std::tolower` 和 `std::isalpha`，减少函数调用开销。
    
## 三、 性能改进

时间复杂度：通过用 `std::unordered_map` 替换 `std::map`，降低了查找和插入的成本。
内存效率：避免动态内存分配，直接使用对象，减少内存碎片和指针开销。
排序速度：`std::vector` 排序扩展性更好，资源消耗更少。
```
wordst_bad.cpp Time taken: 399 ms
wordst_good.cpp Time taken: 270 ms
```
性能提高比例：约 `32.33%`